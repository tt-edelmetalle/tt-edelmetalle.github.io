<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Experten-Quiz: Edelmetalle & Märkte | T&T Edelmetalle</title>
    <meta name="description" content="Testen Sie Ihr Fachwissen über Gold, Silber, Platin und Märkte. 10 Fragen pro Schwierigkeitsstufe im interaktiven Edelmetall-Quiz." />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
    :root {
        --c-primary: #c5a059;
        --c-primary-dark: #a38234;
        --c-bg-app: #0b1120;
        --c-bg-card: #121824;
        --c-text-main: #f1f5f9;
        --c-text-muted: #9aa7bb;
        --c-border: #24313f;
        --c-success: #10b981;
        --c-danger: #ef4444;
        --radius-lg: 14px;
        --font-stack: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
        --nav-height: 72px;
        --glass: rgba(255,255,255,0.03);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }

    body {
        margin: 0;
        padding: 0;
        font-family: var(--font-stack);
        background: linear-gradient(180deg,#070912 0%,var(--c-bg-app) 100%);
        color: var(--c-text-main);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        -webkit-tap-highlight-color: transparent;
    }

    .container { max-width: 1400px; margin: 0 auto; padding: 0 16px; }
    .grid-dashboard { display: grid; gap: 20px; grid-template-columns: 1fr; }
    @media(min-width:1024px) { .grid-dashboard { grid-template-columns: 320px 1fr; } }

    .navbar {
        position: sticky; top: 0; z-index: 120; height: var(--nav-height);
        display: flex; align-items: center; backdrop-filter: blur(8px);
        background: linear-gradient(180deg, rgba(11,17,32,0.95), rgba(11,17,32,0.8));
        border-bottom: 1px solid var(--c-border); padding: 0 8px;
    }
    .nav-inner { width: 100%; max-width: 1400px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; gap: 12px; }

    a { text-decoration: none; color: inherit; }

    h1.brand-logo {
        display: flex; align-items: center; gap: 10px; cursor: pointer;
        font-weight: 700; font-size: 1.15rem; margin: 0; padding: 0;
        border: none; background: none; color: inherit;
    }
    .brand-logo span { color: var(--c-primary); }

    .nav-menu { display: flex; gap: 8px; align-items: center; }
    .nav-item {
        padding: 8px 12px; border-radius: 10px; color: var(--c-text-muted);
        font-weight: 600; cursor: pointer; transition: all 160ms ease;
        display: inline-block;
    }
    .nav-item:hover { color: var(--c-text-main); background: var(--glass); }
    .nav-item.active { background: linear-gradient(90deg,var(--c-primary),var(--c-primary-dark)); color: #000; }

    #hamburger { display: none; }
    @media(max-width:900px) {
        .nav-menu { display: none; }
        #hamburger { display: inline-flex; }
    }

    /* mobile drawer */
    #mobile-overlay { display:none; }
    #mobile-nav { display:none; }

    .card {
        background: var(--c-bg-card); border: 1px solid var(--c-border); border-radius: var(--radius-lg);
        padding: 20px; display: flex; flex-direction: column; gap: 12px;
        box-shadow: 0 8px 30px rgba(2,6,23,0.6); transition: transform 220ms cubic-bezier(.2,.9,.2,1), box-shadow 220ms;
    }
    .card:hover { transform: translateY(-4px); box-shadow: 0 18px 45px rgba(2,6,23,0.7); }
    .card-header { display: flex; justify-content: space-between; align-items: center; gap: 12px; padding-bottom: 6px; border-bottom: 1px solid rgba(255,255,255,0.03); }
    .card-title { font-weight: 700; font-size: 1rem; color: var(--c-text-main); display: flex; align-items: center; gap: 8px; margin: 0; }
    .card-title i { color: var(--c-primary); }

    .form-control {
        width: 100%; background: transparent; border: 1px solid var(--c-border);
        color: var(--c-text-main); padding: 10px 12px; border-radius: 8px; font-size: 0.95rem;
    }
    .input-label { font-size: 0.72rem; text-transform: uppercase; color: var(--c-text-muted); margin-bottom: 6px; display: block; }

    .btn {
        display: inline-flex; align-items: center; justify-content: center; gap: 8px;
        padding: 10px 14px; border-radius: 10px; font-weight: 600; cursor: pointer;
        transition: all 180ms ease; border: 1px solid transparent; text-decoration: none;
        background: transparent; color: var(--c-text-main);
    }
    .btn-primary { background: linear-gradient(135deg,var(--c-primary),var(--c-primary-dark)); color: #000; }
    .btn-outline { background: transparent; border-color: var(--c-border); color: var(--c-text-muted); }
    .btn-outline.active { border-color: var(--c-primary); color: var(--c-primary); background: rgba(197,160,89,0.03); }

    .hero-section {
        text-align: center;
        padding: 40px 16px;
        background: radial-gradient(circle at center, rgba(197,160,89,0.04) 0%, transparent 70%);
        border-radius: var(--radius-lg);
        margin: 22px 0;
    }
    /* Fix: use visible color fallback to avoid gradient-only text issue */
    .hero-title {
        font-size: clamp(1.6rem, 4vw, 2.8rem);
        font-weight: 800;
        margin: 0 0 8px 0;
        color: var(--c-text-main); /* visible fallback, avoids being a plain bar in some browsers */
    }
    .hero-text { color: var(--c-text-muted); margin: 0; }

    .quiz-wrapper { max-width: 980px; margin: 0 auto 48px; padding: 12px; }

    .difficulty-row { display:flex; gap:10px; align-items:center; margin-bottom:8px; flex-wrap:wrap; }
    .difficulty-row .btn { padding:8px 12px; font-size:0.95rem; border-radius:10px; }
    .difficulty-label { color:var(--c-text-muted); font-weight:600; font-size:0.9rem; margin-right:6px; }

    .progress-bar {
        height: 10px;
        background: rgba(255,255,255,0.02);
        border-radius: 999px;
        overflow: hidden;
        margin-bottom: 12px;
        border: 1px solid rgba(255,255,255,0.02);
    }
    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--c-primary), var(--c-primary-dark));
        width: 0%;
        transition: width 0.45s ease;
        border-radius: 999px;
        box-shadow: 0 2px 8px rgba(197,160,89,0.08);
    }

    .top-meta { display:flex; justify-content:space-between; align-items:center; gap:10px; color:var(--c-text-muted); font-size:0.95rem; }

    .question-text {
        font-size: 1.15rem;
        font-weight: 700;
        margin: 6px 0 12px;
        color: var(--c-text-main);
        line-height: 1.35;
    }

    .options-wrap { display:flex; flex-direction:column; gap:12px; }

    .option-btn {
        display: flex;
        align-items: center;
        width: 100%;
        text-align: left;
        padding: 14px 18px;
        border-radius: 12px;
        border: 1px solid var(--c-border);
        background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
        color: var(--c-text-main);
        cursor: pointer;
        transition: transform .14s ease, box-shadow .14s ease, background .12s ease;
        font-size: 1rem;
        position: relative;
        gap:8px;
        font-weight: 600;
    }
    .option-btn span { flex:1; }

    @media (hover:hover) {
        .option-btn:not(.disabled):hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(2,6,23,0.6);
            background: linear-gradient(90deg, rgba(197,160,89,0.03), rgba(165,130,52,0.02));
        }
    }

    .option-btn.disabled { cursor: default; opacity: 0.98; }

    .option-btn.correct {
        background: linear-gradient(90deg, rgba(16,185,129,0.08), rgba(16,185,129,0.03));
        border-color: rgba(16,185,129,0.18);
        color: var(--c-success);
        font-weight: 700;
    }
    .option-btn.wrong {
        background: linear-gradient(90deg, rgba(239,68,68,0.06), rgba(239,68,68,0.02));
        border-color: rgba(239,68,68,0.18);
        color: var(--c-danger);
        font-weight: 700;
    }

    .feedback-icon { margin-left: 8px; font-size: 1.05rem; }

    .explanation-box {
        display: none;
        background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
        border-left: 4px solid rgba(197,160,89,0.12);
        padding: 14px 16px;
        border-radius: 8px;
        color: var(--c-text-muted);
        font-size: 0.95rem;
    }
    .explanation-box.visible { display: block; }

    .btn-next {
        background: linear-gradient(135deg,var(--c-primary),var(--c-primary-dark));
        color: #000;
        border: none;
        padding: 12px 20px;
        border-radius: 10px;
        font-size: 1rem;
        font-weight: 700;
        cursor: pointer;
        margin-left: auto;
        margin-top: 12px;
        display: none;
        transition: transform .12s ease, opacity .12s ease;
        box-shadow: 0 8px 30px rgba(2,6,23,0.6);
    }
    .btn-next.visible { display: inline-flex; align-items:center; gap:8px; }
    .btn-next:hover { transform: translateY(-3px); opacity: 0.98; }

    .result-score { font-size: 2.6rem; font-weight: 800; color: var(--c-primary); margin: 10px 0; }
    .result-msg { color: var(--c-text-muted); font-size: 1.05rem; margin-bottom: 12px; }

    footer { background: var(--c-bg-card); border-top: 1px solid var(--c-border); padding: 28px 0; text-align: center; color: var(--c-text-muted); font-size: 0.88rem; }
    .btn:focus, .form-control:focus, .nav-item:focus { outline: 3px solid rgba(197,160,89,0.12); outline-offset: 2px; }

    @media(max-width:768px) {
        .container { padding: 0 12px; }
        .card { padding: 14px; }
        .hero-title { font-size: 1.6rem; }
    }
    </style>
</head>
<body>
    <header class="navbar" role="banner" aria-label="Top Navigation">
        <div class="nav-inner">
            <a href="#" class="brand-logo" title="Zur Startseite">
                <i class="fa-solid fa-layer-group" style="color:var(--c-primary);"></i>
                <span>T&T</span> Edelmetalle
            </a>

            <div class="nav-menu" id="navMenu">
                <a href="#" class="nav-item">Marktübersicht</a>
                <a href="#" class="nav-item">Portfolio Rechner</a>
                <a href="#" class="nav-item">Wissenswertes</a>
                <a href="#" class="nav-item active">Quiz</a>
            </div>

            <button id="hamburger" class="btn btn-outline" aria-expanded="false" aria-controls="navMenu" onclick="toggleMobileNav()">
                <i class="fa-solid fa-bars"></i>
            </button>
        </div>
    </header>

    <main class="container quiz-wrapper" id="main-app" role="main">
        <section class="hero-section" aria-hidden="false">
            <h1 class="hero-title">Edelmetall Experten-Quiz</h1>
            <p class="hero-text">Beweisen Sie Ihr Wissen über Märkte, Eigenschaften und Geschichte. Wählen Sie zuerst eine Schwierigkeit.</p>
        </section>

        <article class="card" id="quiz-card" aria-labelledby="quiz-title">
            <div class="card-header" style="flex-direction:column; align-items:stretch; gap:12px;">
                <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
                    <div style="display:flex; align-items:center; gap:12px;">
                        <div class="card-title" id="quiz-title"><i class="fa-solid fa-question"></i> Experten-Quiz</div>
                        <div style="font-size:0.92rem; color:var(--c-text-muted); margin-left:8px;">Wähle Schwierigkeit &amp; starte</div>
                    </div>

                    <div class="top-meta" aria-hidden="true" style="min-width:160px; justify-content:flex-end;">
                        <span id="q-counter">— / 10</span>
                        <span style="display:flex; align-items:center; gap:8px;"><i class="fa-solid fa-trophy" style="color:var(--c-primary);"></i> <span id="score-display">0</span></span>
                    </div>
                </div>

                <div class="difficulty-row" role="radiogroup" aria-label="Schwierigkeitsgrad wählen">
                    <div class="difficulty-label">Schwierigkeit:</div>
                    <button id="btn-easy" class="btn btn-outline" role="radio" aria-checked="false" onclick="selectDifficulty('easy')"><i class="fa-solid fa-seedling"></i> Leicht</button>
                    <button id="btn-medium" class="btn btn-outline" role="radio" aria-checked="false" onclick="selectDifficulty('medium')"><i class="fa-solid fa-chart-line"></i> Mittel</button>
                    <button id="btn-hard" class="btn btn-outline" role="radio" aria-checked="false" onclick="selectDifficulty('hard')"><i class="fa-solid fa-fire"></i> Schwer</button>

                    <div style="margin-left:auto;">
                        <button id="start-btn" class="btn btn-primary" onclick="startSelectedDifficulty()" aria-disabled="true" disabled>Quiz starten</button>
                    </div>
                </div>
            </div>

            <div class="progress-bar" role="progressbar" aria-label="Fortschritt im Quiz">
                <div id="progress" class="progress-fill" style="width:0%"></div>
            </div>

            <div id="quiz-content-area">
                <h2 id="question-text" class="question-text">Wähle eine Schwierigkeit und starte das Quiz.</h2>

                <div id="options-container" class="options-wrap" aria-live="polite"></div>

                <div id="explanation" class="explanation-box" aria-hidden="true"></div>

                <div style="display:flex; justify-content:flex-end;">
                    <button id="next-btn" class="btn-next" onclick="nextQuestion()" aria-hidden="true">Nächste Frage <i class="fa-solid fa-arrow-right"></i></button>
                </div>
            </div>

            <div id="result-container" style="display:none; text-align:center; padding: 20px 0;">
                <i class="fa-solid fa-medal fa-3x" style="color:var(--c-primary); margin-bottom:10px;"></i>
                <h2 id="result-title">Quiz beendet!</h2>
                <div class="result-score" id="final-score">0/10</div>
                <p id="result-text" class="result-msg"></p>
                <div style="display:flex; gap:8px; justify-content:center; margin-top:12px;">
                    <button class="btn btn-primary" onclick="restartSameDifficulty()">Quiz neu starten</button>
                    <button class="btn btn-outline" onclick="resetToDifficultySelection()">Andere Schwierigkeit wählen</button>
                </div>
            </div>
        </article>
    </main>

    <footer>
        <div class="container" style="display:flex; flex-direction:column; gap:8px; align-items:center;">
            <div style="display:flex; gap:10px; align-items:center;">
                <i class="fa-solid fa-layer-group" style="color:var(--c-primary);"></i>
                <strong style="color:var(--c-text-main)">T&T Edelmetalle</strong>
            </div>
            <div style="text-align:center; color:var(--c-text-muted); font-size:0.85rem;">
                &copy; 2025. Alle Rechte vorbehalten.
            </div>
        </div>
    </footer>

    <script>
        // Mobile nav minimal
        function toggleMobileNav() {
            const nav = document.getElementById('navMenu');
            nav.classList.toggle('active');
            const expanded = nav.classList.contains('active');
            document.getElementById('hamburger').setAttribute('aria-expanded', expanded ? 'true' : 'false');
        }

        // --- Fragebänke: jeweils 10 professionelle Fragen pro Schwierigkeitsgrad ---
        const EASY = [
            { q: "Welche Farbe hat reines Gold in normalem Licht?", o: ["Silbrig", "Gelb", "Blau", "Fahlgrün"], a: 1, info: "Reines Gold erscheint gelblich aufgrund seiner elektronischen Struktur, die bestimmte Wellenlängen absorbiert." },
            { q: "Welche Einheit wird im Edelmetallhandel für Münzen und Barren oft benutzt?", o: ["Gramm", "Kilogramm", "Feinunze (troy oz)", "Unze (avoirdupois)"], a: 2, info: "Die Feinunze (troy ounce) ist der Standard für Edelmetalle (~31,1035 g)." },
            { q: "Welches Metall neigt am stärksten zur Anlaufen/Verfärbung?", o: ["Gold", "Silber", "Platin", "Palladium"], a: 1, info: "Silber läuft (tarnishes) aufgrund von Schwefelverbindungen in der Luft an." },
            { q: "Wie nennt man 999er Gold häufiger?", o: ["Feingold", "Halbgold", "Sterling", "14 Karat"], a: 0, info: "999er steht für nahezu reines Gold (99,9 %), oft als Feingold bezeichnet." },
            { q: "Welches Metall ist typischerweise am teuersten pro Gewichtseinheit (historisch)?", o: ["Silber", "Kupfer", "Gold", "Aluminium"], a: 2, info: "Gold war lange Zeit wertvoller als Silber und ist oft teurer pro Gewichtseinheit." },
            { q: "Was ist ein gängiger Reinheitsstempel bei Silberbesteck?", o: ["925", "585", "999", "750"], a: 0, info: "925 steht für Sterlingsilber (92,5% Silber, 7,5% meist Kupfer)." },
            { q: "Welches Edelmetall ist bekannt für sehr gute Korrosionsbeständigkeit?", o: ["Eisen", "Kupfer", "Platin", "Zink"], a: 2, info: "Platin ist chemisch sehr inert und korrodiert kaum." },
            { q: "Was bedeutet 'barren' im Edelmetallkontext?", o: ["Münze", "Geprägtes Wertpapier", "Gegossener Metallblock", "Legierter Draht"], a: 2, info: "Ein Barren ist ein gegossener oder geprägter Block eines Edelmetalls, oft standardisiert." },
            { q: "Welche Methode wird oft verwendet, um Feinheit von Gold zu messen (Schnelltest)?", o: ["Röntgenfluoreszenz (XRF)", "PCR-Test", "Spektralphotometer", "pH-Indikator"], a: 0, info: "XRF ist ein zerstörungsfreier Standardtest zur Bestimmung der Metallzusammensetzung." },
            { q: "Warum bevorzugt man bei Schmuck häufig legiertes Gold statt 24k?", o: ["Billiger", "Härter & widerstandsfähiger", "Besserer Glanz", "Leichter zu schmelzen"], a: 1, info: "Weiches 24k Gold wird mit Legierungsmetallen härter und widerstandsfähiger gemacht." }
        ];

        const MEDIUM = [
            { q: "Was kennzeichnet einen 'Good Delivery' Goldbarren formal?", o: ["12,5 kg & anerkannte Raffinerie", "1 kg mit Prüfsiegel", "24 Karat-Only", "Nur für Münzprägeanstalten"], a: 0, info: "Good Delivery Barren ~400 oz (ca. 12,44 kg) von akkreditierten Raffinerien sind Standard im Interbankenhandel." },
            { q: "Welche Auswirkung hat ein starker US-Dollar in der Regel auf den Goldpreis?", o: ["Gold steigt", "Gold fällt", "Kein Einfluss", "Gold wird volatiler aber bleibt gleich"], a: 1, info: "Ein stärkerer US-Dollar macht Gold für Inhaber anderer Währungen teurer und drückt tendenziell den Preis." },
            { q: "Welches Metall ist als sehr effektiver Katalysator in Abgasreinigern für Benziner bekannt?", o: ["Palladium", "Gold", "Silber", "Kupfer"], a: 0, info: "Palladium wird häufig in Katalysatoren für Benzinmotoren verwendet." },
            { q: "Was bedeutet 'Lot' im Edelmetallhandel (z.B. beim Handel mit Futures)?", o: ["Einheitsgewicht der Lieferung", "Reinheitsgrad", "Verpackungsart", "Handelsgebühr"], a: 0, info: "Lot bezeichnet die standardisierte Menge, z.B. eine Kontraktgröße bei Futures." },
            { q: "Welches Land war historisch führend im Goldabbau (20. Jh.) und prägt noch Märkte?", o: ["Südafrika", "China", "Peru", "USA"], a: 0, info: "Südafrika war lange Zeit der größte Produzent; aktuell hat sich das Bild verschoben (z.B. China bedeutend)." },
            { q: "Was ist 'London Fix' (historisch) im Zusammenhang mit Goldpreisen?", o: ["Tägliche Referenzpreis-Festsetzung", "Transportfirma", "Münzprägung", "Schmelzverfahren"], a: 0, info: "Der London Gold Fix war ein täglicher Referenzpreis, der als Benchmark im Handel diente." },
            { q: "Welche Eigenschaft macht Platin wertvoll in der Industrie (automotive) neben Seltenheit?", o: ["Hochleitfähig", "Katalytische Aktivität", "Malleabilität", "Geringe Dichte"], a: 1, info: "Platin ist ein ausgezeichneter Katalysator, daher industriell sehr wichtig." },
            { q: "Warum sind Feinunze-Preise sinnvoller für internationale Vergleiche als Grammpreise?", o: ["Historische Konvention & Liquidität", "Bessere Lesbarkeit", "Staatliche Regelung", "Rundungsfehler vermeiden"], a: 0, info: "Feinunze ist Marktstandard und erleichtert internationalen Handel und Vergleichbarkeit." },
            { q: "Welche Rolle spielt 'Recycling' bei der Goldversorgung?", o: ["Unbedeutend", "Signifikanter Anteil (Sekundärversorgung)", "Nur für Schmuck", "Nur in Bankreserven"], a: 1, info: "Altgoldrecycling liefert einen signifikanten Anteil der verfügbaren Goldmenge." },
            { q: "Welches Risiko beeinflusst besonders physische Lagerhaltung von Edelmetallen?", o: ["Inflation", "Diebstahl & Verwahrungskosten", "Währungswechselkurs", "Dividendenausfall"], a: 1, info: "Lagerung bringt Sicherheits- und Versicherungskosten, daher Kosten/Risiken." }
        ];

        const HARD = [
            { q: "Welche metallurgische Eigenschaft unterscheidet Gold-Legierungen mit Kupfer vs. Nickel als Weißmacher?", o: ["Härte", "Oxidationsverhalten & Farbton", "Elektrische Leitfähigkeit", "Dichte"], a: 1, info: "Kupfer vs. Nickel beeinflussen Farbe, Allergie-Verhalten und Oxidationsverhalten (Nickelweiß häufig heller)." },
            { q: "Wie wirkt sich eine Erhöhung der globalen Minenproduktion kurzfristig auf den Goldpreis aus (Marktmechanik)?", o: ["Sofortiger Preissturz", "Angebotsdruck, aber Markt kann antizipieren & Teil bereits eingepreist werden", "Keine Wirkung", "Nur langfristig relevant"], a: 1, info: "Minenproduktion beeinflusst Angebot, Märkte antizipieren Änderungen; kurzfristig kann Preis moderat reagieren." },
            { q: "Welches Messverfahren liefert zerstörungsfrei den genauesten Reinheitswert am Ort (Refinery/Assay)?", o: ["Aqua Regia (chemisch)", "XRF (schnell) kombiniert mit Fire Assay (referenz)", "Röntgenaufnahme", "ICP-OES vor Ort"], a: 1, info: "XRF ist schnell und zerstörungsfrei; Fire Assay bleibt Goldstandard für Genauigkeit." },
            { q: "Was ist ein typisches Merkmal eines 'London Good Delivery' Zertifikats (Raffinerie) bezüglich Reinheit?", o: ["Mind. 995,0‰ für Gold", "Genau 999,999‰", "Mind. 900‰", "Keine Reinheitsangabe"], a: 0, info: "London Good Delivery Barren haben definierte Reinheitsanforderungen (meist > 995/1000)." },
            { q: "Welches Edelmetall hat den höchsten Schmelzpunkt?", o: ["Gold", "Wolfram (kein Edelmetall)", "Iridium", "Platin"], a: 2, info: "Iridium (ein Platin-Gruppen-Metall) hat extrem hohen Schmelzpunkt relativ zu vielen Edelmetallen." },
            { q: "Wodurch unterscheiden sich 'allocated' vs. 'unallocated' Lagerkonzepte für physisches Gold?", o: ["Allocated = physisch zugewiesen; Unallocated = Forderungsposition (pool)", "Allocated = teurer", "Keine praktischen Unterschiede", "Allocated = nur Münzen"], a: 0, info: "Allocated bedeutet konkrete Identifikation der einzelnen Barren/Münzen; unallocated ist eine buchmäßige Forderung." },
            { q: "Welche Rolle spielt Rhodium in Katalysatoren und warum ist sein Preis oft extrem volatil?", o: ["Weniger wirksam als Palladium", "Sehr knappes Angebot & hohe Nachfrage für Katalyse, begrenzte Recyclingpfade", "Nur als Legierungsmetall für Schmuck", "Ersetzt Silber in Elektronik"], a: 1, info: "Rhodium ist selten und stark nachgefragt für Katalysatoren; begrenzte Versorgung erzeugt Volatilität." },
            { q: "Welche Kennzahl ist wichtig, um die Liquidität eines Edelmetallprodukts (z.B. Münze) zu beurteilen?", o: ["Händleranzahl & Bid-Ask-Spanne", "Gewicht", "Prägejahr", "Farbton"], a: 0, info: "Liquidität bestimmt sich aus Handelsvolumen, Anzahl Marktteilnehmern und Bid-Ask-Spanne." },
            { q: "Was beschreibt ein 'basis risk' bei physischem vs. Termingeschäft auf Gold?", o: ["Differenz zwischen Spot- und Futures-Preis bei Lieferung", "Währungsrisiko", "Transportrisiko", "Lagerkosten"], a: 0, info: "Basis Risk ist die Differenz zwischen Spotpreis und Futurespreis (relevant bei Hedging)." },
            { q: "Welche Herausforderung besteht beim Einsatz von ICP-OES für sehr kleine Goldkonzentrationen im Recyclingstrom?", o: ["Interferenzen & Matrixeffekte erfordern aufwendige Aufbereitung", "Fehlende Empfindlichkeit", "Zu teuer", "Nicht standardisiert"], a: 0, info: "Matrixeffekte können Messungen verfälschen; Probenaufbereitung ist kritisch." }
        ];

        // Variables
        let selectedDifficulty = null;
        let quizData = [];
        let currentState = { index: 0, score: 0, answered: false };

        // Elements
        const elQuestionText = document.getElementById('question-text');
        const elOptionsContainer = document.getElementById('options-container');
        const elProgress = document.getElementById('progress');
        const elCounter = document.getElementById('q-counter');
        const elScoreDisplay = document.getElementById('score-display');
        const elExplanation = document.getElementById('explanation');
        const elNextBtn = document.getElementById('next-btn');
        const elResultContainer = document.getElementById('result-container');
        const elQuizContent = document.getElementById('quiz-content-area');
        const startBtn = document.getElementById('start-btn');

        // Difficulty selection handlers
        function selectDifficulty(level) {
            selectedDifficulty = level;
            document.getElementById('btn-easy').classList.toggle('active', level === 'easy');
            document.getElementById('btn-medium').classList.toggle('active', level === 'medium');
            document.getElementById('btn-hard').classList.toggle('active', level === 'hard');

            // update aria-checked
            document.getElementById('btn-easy').setAttribute('aria-checked', level === 'easy');
            document.getElementById('btn-medium').setAttribute('aria-checked', level === 'medium');
            document.getElementById('btn-hard').setAttribute('aria-checked', level === 'hard');

            startBtn.disabled = false;
            startBtn.setAttribute('aria-disabled','false');
        }

        function startSelectedDifficulty() {
            if (!selectedDifficulty) return;
            // assign appropriate set (clone to avoid mutation)
            if (selectedDifficulty === 'easy') quizData = JSON.parse(JSON.stringify(EASY));
            else if (selectedDifficulty === 'medium') quizData = JSON.parse(JSON.stringify(MEDIUM));
            else quizData = JSON.parse(JSON.stringify(HARD));

            // reset state
            currentState.index = 0;
            currentState.score = 0;
            currentState.answered = false;
            elResultContainer.style.display = 'none';
            elQuizContent.style.display = '';
            elScoreDisplay.innerText = '0';
            elProgress.style.width = '0%';
            document.getElementById('q-counter').innerText = `Frage 1 / ${quizData.length}`;
            loadQuestion();
            // Scroll to quiz on mobile
            setTimeout(()=>{ document.getElementById('quiz-card').scrollIntoView({behavior:'smooth'}); }, 80);
        }

        function loadQuestion() {
            const data = quizData[currentState.index];
            currentState.answered = false;
            elExplanation.classList.remove('visible');
            elExplanation.setAttribute('aria-hidden', 'true');
            elNextBtn.classList.remove('visible');
            elNextBtn.setAttribute('aria-hidden', 'true');
            elOptionsContainer.innerHTML = '';

            elQuestionText.innerText = data.q;
            elCounter.innerText = `Frage ${currentState.index + 1} / ${quizData.length}`;

            const progressPercent = ((currentState.index) / quizData.length) * 100;
            elProgress.style.width = `${progressPercent}%`;

            data.o.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.type = 'button';
                btn.innerHTML = `<span>${opt}</span>`;
                btn.onclick = () => handleAnswer(i, btn);
                btn.setAttribute('aria-pressed','false');
                elOptionsContainer.appendChild(btn);
            });
        }

        function handleAnswer(selectedIndex, btnElement) {
            if (currentState.answered) return;
            currentState.answered = true;
            const currentData = quizData[currentState.index];
            const allBtns = Array.from(document.querySelectorAll('.option-btn'));

            const iconCorrect = `<i class="fa-solid fa-check feedback-icon" aria-hidden="true"></i>`;
            const iconWrong = `<i class="fa-solid fa-xmark feedback-icon" aria-hidden="true"></i>`;

            allBtns.forEach(btn => {
                btn.classList.add('disabled');
                btn.setAttribute('aria-disabled', 'true');
            });

            if (selectedIndex === currentData.a) {
                btnElement.classList.add('correct');
                btnElement.insertAdjacentHTML('beforeend', iconCorrect);
                currentState.score++;
                elScoreDisplay.innerText = currentState.score;
            } else {
                btnElement.classList.add('wrong');
                btnElement.insertAdjacentHTML('beforeend', iconWrong);
                const correctBtn = allBtns[currentData.a];
                if (correctBtn) {
                    correctBtn.classList.add('correct');
                    correctBtn.insertAdjacentHTML('beforeend', iconCorrect);
                }
            }

            elExplanation.innerHTML = `<strong>Wissenswert:</strong> ${currentData.info}`;
            elExplanation.classList.add('visible');
            elExplanation.setAttribute('aria-hidden','false');

            elNextBtn.innerText = (currentState.index === quizData.length - 1) ? "Zum Ergebnis" : "Nächste Frage";
            elNextBtn.classList.add('visible');
            elNextBtn.setAttribute('aria-hidden','false');

            // focus next button for keyboard users
            setTimeout(()=> elNextBtn.focus(), 120);
        }

        function nextQuestion() {
            currentState.index++;
            if (currentState.index < quizData.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            elQuizContent.style.display = 'none';
            elResultContainer.style.display = 'block';
            elProgress.style.width = '100%';
            elCounter.innerText = "Beendet";
            document.getElementById('final-score').innerText = `${currentState.score} / ${quizData.length}`;

            const percentage = (currentState.score / quizData.length) * 100;
            let msg = "";
            if (percentage === 100) msg = "Perfekt! Sie sind ein wahrer Edelmetall-Experte.";
            else if (percentage >= 80) msg = "Hervorragend! Sie kennen sich sehr gut aus.";
            else if (percentage >= 50) msg = "Gut gemacht! Sie haben solides Basiswissen.";
            else msg = "Ein guter Anfang. Nutzen Sie unseren Wissensbereich, um mehr zu lernen.";

            document.getElementById('result-text').innerText = msg;
        }

        function restartSameDifficulty() {
            // restart with same set
            if (!selectedDifficulty) return;
            startSelectedDifficulty();
        }

        function resetToDifficultySelection() {
            // show selection state
            elResultContainer.style.display = 'none';
            elQuizContent.style.display = '';
            elQuestionText.innerText = 'Wähle eine Schwierigkeit und starte das Quiz.';
            elOptionsContainer.innerHTML = '';
            elExplanation.classList.remove('visible');
            elScoreDisplay.innerText = '0';
            elProgress.style.width = '0%';
            selectedDifficulty = null;
            document.getElementById('btn-easy').classList.remove('active');
            document.getElementById('btn-medium').classList.remove('active');
            document.getElementById('btn-hard').classList.remove('active');
            document.getElementById('btn-easy').setAttribute('aria-checked','false');
            document.getElementById('btn-medium').setAttribute('aria-checked','false');
            document.getElementById('btn-hard').setAttribute('aria-checked','false');
            startBtn.disabled = true;
            startBtn.setAttribute('aria-disabled','true');
            document.getElementById('q-counter').innerText = `— / 10`;
            // scroll to selection
            setTimeout(()=> document.querySelector('.difficulty-row').scrollIntoView({behavior:'smooth'}), 80);
        }

        // init: disable start until difficulty chosen
        (function init() {
            startBtn.disabled = true;
            startBtn.setAttribute('aria-disabled','true');
            document.getElementById('q-counter').innerText = `— / 10`;
        })();
    </script>
</body>
</html>
